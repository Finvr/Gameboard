<div class="myGames">
  <div class="row">
    <div class="col m4">
      <section>
        <ul class="collapsible popout with-header" data-collapsible="accordion" watch>
          <li class="collection-header">
            <span class="pink-text text-darken-2"><h5>Games I'm Hosting</h5></span>
          </li>
          <li ng-repeat="game in myGames" class="collection-item avatar">
            <div class="collapsible-header">
              <i class="material-icons md-light">info</i>
              <span class="title indigo-text text-darkern-2">
                {{ game.game}}
              </span>
              <a href="#modal1" ng-click="getGamepostRequest(game)" class="waves-effect waves-light secondary-content" modal><i class="material-icons" ng-if="game.pending_requests > 0">add_alert</i></a>
              <a href="#cancelGamepostModal" ng-click="setGameToCancel(game)" class="waves-effect waves-light secondary-content" modal><i class="material-icons">cancel</i></a>
              <p>
                <strong>Time:</strong> {{ game.game_datetime | date : "EEE, MMM d, y @ h:mm a" }}<br>
                <strong>Location:</strong> {{ game.game_location }}
              </p>
            </div>
            <div class="collapsible-body">
              <p>
                <span>Players:</span> {{game.player_count}}
                <br>
                <span>Description:</span> {{game.gamepost_description}}<br>
              </p>
            </div>
          </li>
        </ul>
      </section>
    </div>
    <div class="col m4">
      <section class="joined">
        <ul class="collapsible popout with-header" data-collapsible="accordion" watch>
          <li class="collection-header"><span class="pink-text text-darken-2"><h5>Games I'm Joining</h5></span></li>
          <!-- must be changed to only request that are pending-->
          <li ng-repeat="request in myRequests" class="collection-item avatar" ng-if="request.status==='accepted'">
            <div class="collapsible-header">
              <i class="material-icons md-light">info</i>
              <span class="title indigo-text text-darkern-2">
                {{ request.game}}
              </span>
              <a href="#cancelRequestModal" ng-click="setRequestToCancel(request)" class="waves-effect waves-light secondary-content" modal><i class="material-icons">cancel</i></a>
              <p>
                <strong>Time:</strong> {{ request.game_datetime | date : "EEE, MMM d, y @ h:mm a" }}<br>
                <strong>Location:</strong> {{ request.game_location }}
              </p>
            </div>
            <div class="collapsible-body">
              <p>
                <span class="pink-text text-darken-2">Comments: </span> {{ request.comments }}
              </p>
            </div>
          </li>
        </ul>
      </section>
    </div>
    <div class="col m4">
      <section class="joined">
        <ul class="collapsible popout with-header" data-collapsible="accordion" watch>
          <li class="collection-header"><span class="pink-text text-darken-2"><h5>My Pending Requests</h5></span></li>
          <!-- must be changed to only request that are pending-->
          <li ng-repeat="request in myRequests" class="collection-item avatar" ng-if="request.status==='pending'">
            <div class="collapsible-header">
              <i class="material-icons md-light">info</i>
              <span class="title indigo-text text-darkern-2">
                {{ request.game}}
              </span>
              <a href="#cancelRequestModal" ng-click="setRequestToCancel(request)" class="waves-effect waves-light secondary-content" modal><i class="material-icons">cancel</i></a>
              <p>
                <strong>Time:</strong> {{ request.game_datetime | date : "EEE, MMM d, y @ h:mm a" }}<br>
                <strong>Location:</strong> {{ request.game_location }}
              </p>
            </div>
            <div class="collapsible-body">
              <p>
                <span class="pink-text text-darken-2">Message sent: </span> {{ request.comments }}
              </p>
            </div>
          </li>
        </ul>
      </section>
      <section class="declined">
        <ul class="collapsible popout with-header" data-collapsible="accordion" watch>
          <li class="collection-header"><span class="pink-text text-darken-2"><h5>Declined Requests</h5></span></li>
          <!-- must be changed to only request that are pending-->
          <li ng-repeat="request in myRequests" class="collection-item avatar" ng-if="request.status==='declined'">
            <div class="collapsible-header">
              <i class="material-icons md-light">info</i>
              <span class="title indigo-text text-darkern-2">
                {{ request.game}}
              </span>
              <p>
                <strong>Time:</strong> {{ request.game_datetime | date : "EEE, MMM d, y @ h:mm a" }}<br>
                <strong>Location:</strong> {{ request.game_location }}
              </p>
            </div>
            <div class="collapsible-body">
              <p>
                <span class="pink-text text-darken-2">Comments: </span> {{ request.comments }}
              </p>
            </div>
          </li>
        </ul>
      </section>
    </div>
  </div>
  <!-- Pop-up modal for requests of gameposts -->
  <div id="modal1" class="modal approve-pending">
    <div class="modal-header">
      <h4 class="white-text">Pending Request</h4>
    </div>
    <div class="modal-content container"> 
      <!-- requests list of the gamepost -->
      <ul class="collection">
        <li ng-repeat="request in requests" class="collection-item avatar row">
          <i class="material-icons left col s1">email</i>
          <div class="col s10">
            <span class="title col s12"><strong>Request from: {{request.username}}</strong></span>
            <span class="col s12"><strong>Status:</strong> {{request.status}}</span><br>           
            <span class="col s12"><strong>Message:</strong>  {{ request.comments }}</span>
          </div>
          <p class="center row" ng-if="request.status==='pending'">
            <button class="col s6 waves-effect waves-light btn-flat btn-medium waves-effect waves-light green white-text" ng-click="requestConfirm('accepted', request)">Accept<i class="material-icons right tiny">done</i></button>
            <button class="col s6 waves-effect waves-light btn-flat waves-effect waves-light red white-text" ng-click="requestConfirm('declined', request)">Decline<i class="material-icons right tiny">not_interested</i></button>
          </p>
        </li> 
      </ul>
    </div>
    <div class="modal-footer">
      <a class="modal-action modal-close waves-effect teal white-text btn-flat">I'm Game!</a>
    </div>
  </div>
  
  <!-- Pop-up modal for cancelling of gameposts -->
  <div id="cancelGamepostModal" class="modal approve-pending">
    <div class="modal-header">
      <h4 class="white-text">Cancel Game</h4>
      <!--<a href=""><i class="material-icons">close</i></a>-->
    </div>
    <div class="modal-content container"> 
        <p>Are you sure you want to cancel this game of {{gameToCancel.game}}?  The game will no longer show up in searches and those who have requested to join this game will be notified that it has been cancelled.</p>
    </div>
    <div class="modal-footer">
      <a ng-click="cancelGame()" class="modal-action modal-close waves-effect teal white-text btn-flat">Cancel Game</a>
    </div>
  </div>
</div>